{
  "title": "Windows Server Health",
  "description": "CPU, Memory, Disk, Network. Filter by environment.",
  "layout_type": "ordered",
  "reflow_type": "fixed",
  "template_variables": [
    {
      "name": "environment",
      "prefix": "environment",
      "available_values": ["production", "qa"],
      "default": "production"
    }
  ],
  "widgets": [
    {
      "id": 0,
      "definition": {
        "type": "note",
        "content": "# CPU, Memory, Disk, Network",
        "background_color": "green",
        "font_size": "14",
        "text_align": "left",
        "vertical_align": "top",
        "show_tick": false,
        "has_padding": true
      },
      "layout": { "x": 0, "y": 0, "width": 12, "height": 2 }
    },

    {
      "id": 1,
      "definition": {
        "type": "timeseries",
        "title": "CPU (5m)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "auto",
        "legend_columns": ["avg", "min", "max", "value"],
        "requests": [
          {
            "formulas": [{ "formula": "query2" }],
            "queries": [
              {
                "data_source": "metrics",
                "name": "query2",
                "query": "avg:system.cpu.system{environment:$environment} by {host}"
              }
            ],
            "response_format": "timeseries",
            "style": { "palette": "dog_classic", "line_type": "solid", "line_width": "normal" },
            "display_type": "line"
          }
        ],
        "markers": [
          { "value": "y = 85", "display_type": "warning dashed" },
          { "value": "y = 95", "display_type": "error dashed" }
        ]
      },
      "layout": { "x": 0, "y": 2, "width": 6, "height": 3 }
    },

    {
      "id": 2,
      "definition": {
        "type": "timeseries",
        "title": "Memory",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "auto",
        "legend_columns": ["avg", "min", "max", "value"],
        "requests": [
          {
            "formulas": [{ "formula": "1 - query2" }],
            "queries": [
              {
                "data_source": "metrics",
                "name": "query2",
                "query": "avg:system.mem.pct_usable{environment:$environment} by {host}"
              }
            ],
            "response_format": "timeseries",
            "style": { "palette": "dog_classic", "line_type": "solid", "line_width": "normal" },
            "display_type": "line"
          }
        ],
        "markers": [
          { "value": "y = 0.85", "display_type": "warning dashed" },
          { "value": "y = 0.95", "display_type": "error dashed" }
        ]
      },
      "layout": { "x": 6, "y": 2, "width": 6, "height": 3 }
    },

    {
      "id": 3,
      "definition": {
        "type": "timeseries",
        "title": "Disk",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "auto",
        "legend_columns": ["avg", "min", "max", "value"],
        "requests": [
          {
            "q": "avg:system.disk.in_use{environment:$environment} by {host}",
            "display_type": "line",
            "style": { "palette": "orange", "line_type": "solid", "line_width": "normal" }
          }
        ],
        "yaxis": { "min": "0", "max": "100", "scale": "linear", "include_zero": true },
        "markers": [
          { "value": "y = 85", "display_type": "warning dashed" },
          { "value": "y = 95", "display_type": "error dashed" }
        ]
      },
      "layout": { "x": 0, "y": 5, "width": 6, "height": 3 }
    },

    {
      "id": 4,
      "definition": {
        "type": "timeseries",
        "title": "Network (bytes in)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "auto",
        "legend_columns": ["avg", "min", "max", "value"],
        "requests": [
          {
            "q": "avg:system.net.bytes_rcvd{environment:$environment} by {host}",
            "display_type": "line",
            "style": { "palette": "green", "line_type": "solid", "line_width": "normal" }
          }
        ],
        "yaxis": { "scale": "linear", "include_zero": true }
      },
      "layout": { "x": 6, "y": 5, "width": 6, "height": 3 }
    },

    {
      "id": 5,
      "definition": {
        "type": "timeseries",
        "title": "Network (bytes out)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "auto",
        "legend_columns": ["avg", "min", "max", "value"],
        "requests": [
          {
            "q": "avg:system.net.bytes_sent{environment:$environment} by {host}",
            "display_type": "line",
            "style": { "palette": "blue", "line_type": "solid", "line_width": "normal" }
          }
        ],
        "yaxis": { "scale": "linear", "include_zero": true }
      },
      "layout": { "x": 0, "y": 8, "width": 12, "height": 3 }
    }
  ]
}
