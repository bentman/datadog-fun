# Windows Event Log Configuration for SCCM Distribution Point (Simplified)
# LCD (Lowest Common Denominator) approach for reliable collection
# Monitors only essential critical errors using proven pattern formats

init_config:

logs:
  # System Event Log - Core system and service errors only
  - type: windows_event
    channel_path: System
    source: windows.events
    service: sccm-distribution-point
    tags:
      - source:windows-system
      - role:sccm-distribution-point
    log_processing_rules:
      - type: include_at_match
        name: critical_system_events
        pattern: '"EventID":"(7000|7001|7031|7034|7036|10016|6008)"'

  # Application Event Log - SCCM DP and IIS core errors only
  - type: windows_event
    channel_path: Application
    source: windows.events
    service: sccm-distribution-point
    tags:
      - source:sccm-application
      - role:sccm-distribution-point
    log_processing_rules:
      - type: include_at_match
        name: sccm_dist_point_errors
        pattern: '"EventID":"(2301|2302|2303|2315|2316)"'
      - type: include_at_match
        name: iis_errors
        pattern: '"EventID":"(1309|1325|2268)"'
      - type: include_at_match
        name: service_errors
        pattern: '"EventID":"(1000|1026|1033)"'

  # Security Event Log - Authentication failures only
  - type: windows_event
    channel_path: Security
    source: windows.events
    service: sccm-distribution-point
    tags:
      - source:windows-security
      - role:sccm-distribution-point
    log_processing_rules:
      - type: include_at_match
        name: auth_failures
        pattern: '"EventID":"(4625|4771|4776)"'
