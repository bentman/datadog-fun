# Windows Service Check Configuration for SCCM Distribution Point
# Monitors critical services for Distribution Point functionality
# Updated with proper service grouping and tagging per Datadog best practices

init_config:

instances:
  # Web Infrastructure Services (IIS) - Critical for Distribution Point
  - services:
      - W3SVC
      - IISADMIN
    tags:
      - role:sccm-distribution-point
      - service_group:web-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Windows Infrastructure Services
  - services:
      - Winmgmt
      - WinRM
      - BITS
    tags:
      - role:sccm-distribution-point
      - service_group:windows-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # SCCM Distribution Point Services
  - services:
      - SMS_DP_MONITOR
    tags:
      - role:sccm-distribution-point
      - service_group:sccm-distribution-point
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # PXE Boot Services (if PXE enabled)
  - services:
      - WDSServer
      - TFTPD
    tags:
      - role:sccm-distribution-point
      - service_group:pxe-boot-services
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Application Pool Services (IIS Application Pools)
  - services:
      - name: WAS
        startup_type: automatic
    tags:
      - role:sccm-distribution-point
      - service_group:iis-application-pools
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Content Distribution Services
  - services:
      - name: BranchCache
        startup_type: automatic
      - name: PeerDistSvc
        startup_type: automatic
    tags:
      - role:sccm-distribution-point
      - service_group:content-distribution
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true