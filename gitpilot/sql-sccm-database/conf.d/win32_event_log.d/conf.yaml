# SQL Server event log monitoring
logs:
  - type: windows_event
    channel_path: Application
    source: windows.events
    service: sql-server
    tags:
      - sql_role:sccm_database
    filters:
      - type: include_at_match
        name: source
        pattern: MSSQLSERVER|SQLSERVERAGENT
      - type: include_at_match
        name: levels
        pattern: critical|error|warning
    
  - type: file
    path: C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\Log\ERRORLOG
    source: sqlserver
    service: sql-server
    tags:
      - sql_role:sccm_database