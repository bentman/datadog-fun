# Windows Event Log Configuration for SCCM Management Point (Simplified LCD)
# Focuses on essential Management Point and client communication errors
# Uses proven pattern format that works in peer configurations

init_config:

logs:
  # System Event Log - Core system and service failures critical to MP
  - type: windows_event
    channel_path: System
    source: windows.events
    service: sccm-management-point
    tags:
      - source:windows-system
      - role:sccm-management-point
    log_processing_rules:
      - type: include_at_match
        name: critical_system_events
        pattern: '"EventID":"(7000|7001|7031|7034|7036|10016|6008)"'

  # Application Event Log - SCCM MP and SQL connection errors only
  - type: windows_event
    channel_path: Application
    source: windows.events
    service: sccm-management-point
    tags:
      - source:sccm-application
      - role:sccm-management-point
    log_processing_rules:
      - type: include_at_match
        name: sccm_mp_component_errors
        pattern: '"EventID":"(1104|1105|1106|1107|1108)"'
      - type: include_at_match
        name: sql_connection_errors
        pattern: '"EventID":"(18456|18452|5612)"'
      - type: include_at_match
        name: wmi_activity_errors
        pattern: '"EventID":"(5858|5857|5859)"'
      - type: include_at_match
        name: service_errors
        pattern: '"EventID":"(1000|1026|1033)"'

  # Security Event Log - Authentication failures affecting MP clients
  - type: windows_event
    channel_path: Security
    source: windows.events
    service: sccm-management-point
    tags:
      - source:windows-security
      - role:sccm-management-point
    log_processing_rules:
      - type: include_at_match
        name: auth_failures
        pattern: '"EventID":"(4625|4771|4776)"'
