# Windows Service Check Configuration for SCCM Management Point
# Monitors critical services for Management Point functionality
# Updated with proper service grouping and tagging per Datadog best practices

init_config:

instances:
  # Web Infrastructure Services (IIS) - Critical for Management Point
  - services:
      - W3SVC
      - IISADMIN
    tags:
      - role:sccm-management-point
      - service_group:web-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Windows Infrastructure Services - Critical for client communication
  - services:
      - Winmgmt
      - WinRM
      - BITS
    tags:
      - role:sccm-management-point
      - service_group:windows-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # SCCM Management Point Services
  - services:
      - SMS_MP_CONTROL_MANAGER
    tags:
      - role:sccm-management-point
      - service_group:sccm-management-point
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Security and SSL Services (if using HTTPS)
  - services:
      - HTTPFilter
      - CertSvc
    tags:
      - role:sccm-management-point
      - service_group:security-ssl
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Application Pool Services (IIS Application Pools)
  - services:
      - name: WAS
        startup_type: automatic
    tags:
      - role:sccm-management-point
      - service_group:iis-application-pools
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true