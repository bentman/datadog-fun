# Process Check Configuration for SCCM Site Server
# Monitors critical SCCM processes for the primary site server

init_config:

instances:
  # SMS Executive - Core SCCM orchestration
  - name: sms_executive
    search_string: ['SMS_EXECUTIVE.exe']
    exact_match: false
    tags:
      - process:sccm-executive
      - service:sccm-core
      - role:sccm-site-server
    thresholds:
      critical: [1, 2, 5m]  # Primary executive process, backup instances possible
      warning: [1, 2, 5m]
    
  # SMS Site Component Manager - Manages all site components
  - name: sms_site_component_manager
    search_string: ['SMS_SITE_COMPONENT_MANAGER.exe']
    exact_match: false
    tags:
      - process:sccm-component-manager
      - service:sccm-site-manager
      - role:sccm-site-server
    thresholds:
      critical: [1, 1, 5m]  # Critical component, should be exactly 1
      warning: [1, 1, 5m]
    
  # SMS Parent Host - Handles parent site communications
  - name: sms_parent_host
    search_string: ['SMS_PARENT_HOST.exe']
    exact_match: false
    tags:
      - process:sccm-parent-host
      - service:sccm-site-comm
      - role:sccm-site-server
    thresholds:
      critical: [0, 2, 5m]  # Optional for child sites, max 2
      warning: [0, 2, 5m]

  # SMS Service Executive - Core SCCM service
  - name: sms_service_executive
    search_string: ['SMS_SERVICE_EXECUTIVE.exe']
    exact_match: false
    tags:
      - process:sccm-service-executive
      - service:sccm-core
      - role:sccm-site-server
    thresholds:
      critical: [1, 1, 5m]  # Primary service executor
      warning: [1, 1, 5m]
    
  # SMS Notification Server - Handles notifications
  - name: sms_notification_server
    search_string: ['SMS_NOTIFICATION_SERVER.exe']
    exact_match: false
    tags:
      - process:sccm-notification-server
      - service:sccm-notifications
      - role:sccm-site-server
    thresholds:
      critical: [1, 2, 5m]  # Notification handling
      warning: [1, 2, 5m]

  # IIS Worker Process - AdminService web interface
  - name: iis_worker
    search_string: ['w3wp.exe']
    exact_match: false
    tags:
      - process:iis-worker
      - service:iis
      - role:sccm-site-server
    thresholds:
      critical: [1, 15, 5m]  # Admin web interface, moderate load
      warning: [1, 8, 5m]
    
  # WMI Provider Host - Critical for SCCM operations
  - name: wmi_provider_host
    search_string: ['wmiprvse.exe']
    exact_match: false
    tags:
      - process:wmi-provider
      - service:wmi
      - role:sccm-site-server
    thresholds:
      critical: [1, 30, 5m]  # Highest WMI load of all SCCM roles
      warning: [1, 20, 5m]
