# Windows Event Log Configuration for SCCM Site Server (Simplified LCD)
# Focuses on essential Site Component Manager and core SCCM functionality errors
# Uses proven pattern format that works in peer configurations

init_config:

logs:
  # System Event Log - Core system failures critical to site operations
  - type: windows_event
    channel_path: System
    source: windows.events
    service: sccm-site-server
    tags:
      - source:windows-system
      - role:sccm-site-server
    log_processing_rules:
      - type: include_at_match
        name: critical_system_events
        pattern: '"EventID":"(7000|7001|7031|7034|7036|6008)"'

  # Application Event Log - SCCM Site Component Manager errors only
  - type: windows_event
    channel_path: Application
    source: windows.events
    service: sccm-site-server
    tags:
      - source:sccm-application
      - role:sccm-site-server
    log_processing_rules:
      - type: include_at_match
        name: sccm_site_component_manager_errors
        pattern: '"EventID":"(4909|4912|4913|4915|1016|1037)"'
      - type: include_at_match
        name: sccm_notification_server_errors
        pattern: '"EventID":"(5858|5857|5859)"'
      - type: include_at_match
        name: critical_site_errors
        pattern: '"EventID":"(1000|1026|1033)"'

  # SQL Server Events - Site database connectivity failures only
  - type: windows_event
    channel_path: Application
    source: windows.events
    service: sccm-site-server
    tags:
      - source:sql-server-site-db
      - role:sccm-site-server
    log_processing_rules:
      - type: include_at_match
        name: sql_connection_errors
        pattern: '"EventID":"(18456|18452|5612)"'
