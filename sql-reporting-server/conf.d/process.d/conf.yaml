# Process Check Configuration for SCCM SQL Reporting Server (Standalone)
# Monitors critical SSRS and reporting processes for SQL Server 2019
# This server has local SQL Server instance, so sqlservr.exe is expected

init_config:

instances:
  # SQL Server Reporting Services Service - Core SSRS
  - name: ssrs_service
    search_string: ['ReportingServicesService.exe']
    exact_match: false
    tags:
      - process:ssrs-service
      - service:ssrs
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [1, 1, 5m]  # Exactly 1 SSRS service
      warning: [1, 1, 5m]

  # SSRS Application Domain Host (SQL Server 2019)
  - name: ssrs_application_domain
    search_string: ['MSRS2019.Application.exe']
    exact_match: false
    tags:
      - process:ssrs-app-domain
      - service:ssrs
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [1, 2, 5m]  # SSRS application domain
      warning: [1, 2, 5m]

  # SSRS Web Application (SQL Server 2019)
  - name: ssrs_web_app
    search_string: ['MSRS2019.WebApp.exe']
    exact_match: false
    tags:
      - process:ssrs-web-app
      - service:ssrs-web
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [1, 3, 5m]  # Web app hosting
      warning: [1, 3, 5m]

  # IIS Worker Process - Report Manager web interface
  - name: iis_worker
    search_string: ['w3wp.exe']
    exact_match: false
    tags:
      - process:iis-worker
      - service:iis
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [1, 15, 5m]  # Report web interface load
      warning: [1, 8, 5m]

  # WMI Provider Host - Critical for SCCM and SSRS
  - name: wmi_provider_host
    search_string: ['wmiprvse.exe']
    exact_match: false
    tags:
      - process:wmi-provider
      - service:wmi
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [1, 25, 5m]  # Moderate WMI load for reporting
      warning: [1, 15, 5m]

  # SQL Server Database Engine Process (Standalone server)
  - name: sql_server_engine
    search_string: ['sqlservr.exe']
    exact_match: false
    tags:
      - process:sql-server-engine
      - service:sql-server
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [1, 1, 5m]  # Local SQL Server should be running
      warning: [1, 1, 5m]

  # Note: Comment out the following process if SSAS is not utilized
  - name: ssas_query_process
    search_string: ['OlapQuery.exe', 'ASConnection.exe']
    exact_match: false
    tags:
      - process:ssas-query
      - service:ssas
      - role:sccm-sql-reporting-server
    thresholds:
      critical: [0, 5, 5m]  # Optional SSAS queries
      warning: [0, 5, 5m]

# Alternative SSRS Process Names for Other SQL Versions:
# SQL Server 2016: MSRS13.Application.exe, MSRS13.WebApp.exe
# SQL Server 2017: MSRS14.Application.exe, MSRS14.WebApp.exe
# SQL Server 2022: MSRS2019.Application.exe, MSRS2019.WebApp.exe (same as 2019)
