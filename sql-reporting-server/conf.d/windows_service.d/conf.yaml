# Windows Service Check Configuration for SCCM SQL Reporting Server
# Monitors critical SQL Server Reporting Services and infrastructure services
# Updated with proper service grouping and tagging per Datadog best practices

init_config:

instances:
  # SQL Server Reporting Services Core
  - services:
      - ReportServer
      - ReportServerTempDB
    tags:
      - role:sccm-sql-reporting-server
      - service_group:ssrs-core
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # SQL Server Services (if local database)
  - services:
      - MSSQLSERVER
      - SQLSERVERAGENT
    tags:
      - role:sccm-sql-reporting-server
      - service_group:sql-server-local
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Web Infrastructure Services (IIS) - For Report Manager and Web Service
  - services:
      - W3SVC
      - IISADMIN
    tags:
      - role:sccm-sql-reporting-server
      - service_group:web-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Windows Infrastructure Services
  - services:
      - Winmgmt
      - WinRM
    tags:
      - role:sccm-sql-reporting-server
      - service_group:windows-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Application Pool Services (IIS Application Pools for SSRS)
  - services:
      - name: WAS
        startup_type: automatic
    tags:
      - role:sccm-sql-reporting-server
      - service_group:iis-application-pools
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Email and Notification Services (if configured)
  - services:
      - SMTPSVC
      - EventSystem
    tags:
      - role:sccm-sql-reporting-server
      - service_group:notification-services
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true