# Process Check Configuration for SCCM SQL Server (Standalone Single Instance)
# Monitors critical SQL Server and SCCM database processes
# Note: This server is standalone single instance, SQL Browser disabled

init_config:

instances:
  # SQL Server Database Engine Process - Core SQL
  - name: sql_server_engine
    search_string: ['sqlservr.exe']
    exact_match: false
    tags:
      - process:sql-server-engine
      - service:sql-server
      - role:sccm-sql-server
    thresholds:
      critical: [1, 1, 5m]  # Single instance, should be exactly 1
      warning: [1, 1, 5m]
    
  # SQL Server Agent Process - Critical for SCCM jobs and schedules  
  - name: sql_server_agent
    search_string: ['sqlagent.exe']
    exact_match: false
    tags:
      - process:sql-server-agent
      - service:sql-server-agent
      - role:sccm-sql-server
    thresholds:
      critical: [1, 1, 5m]  # Exactly 1 agent should be running
      warning: [1, 1, 5m]

  # WMI Provider Host - Critical for SCCM monitoring queries
  - name: wmi_provider_host
    search_string: ['wmiprvse.exe']
    exact_match: false
    tags:
      - process:wmi-provider
      - service:wmi
      - role:sccm-sql-server
    thresholds:
      critical: [1, 25, 5m]  # High WMI load from SCCM queries
      warning: [1, 15, 5m]
    
  # Note: Uncomment SQL Browser for multi-instance environments
  # - name: sql_server_browser
  #   search_string: ['sqlbrowser.exe']
  #   exact_match: false
  #   tags:
  #     - process:sql-server-browser
  #     - service:sql-server-browser
  #     - role:sccm-sql-server
  #   thresholds:
  #     critical: [1, 1, 5m]  # Browser for multi-instance discovery
  #     warning: [1, 1, 5m]

  # Note: Uncomment SSAS if Analysis Services runs on this server
  # Note: SSAS is currently running on the reporting server, not here
  # - name: ssas_service
  #   search_string: ['msmdsrv.exe']
  #   exact_match: false
  #   tags:
  #     - process:ssas-engine
  #     - service:ssas
  #     - role:sccm-sql-server
  #   thresholds:
  #     critical: [0, 1, 5m]  # Optional SSAS deployment
  #     warning: [0, 1, 5m]
