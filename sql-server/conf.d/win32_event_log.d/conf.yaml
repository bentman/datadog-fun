# Windows Event Log Configuration for SCCM SQL Server (Simplified LCD)
# Focuses on critical system and SQL connectivity errors affecting SCCM
# Uses proven pattern format that works in peer configurations

init_config:

logs:
  # System Event Log - Critical system failures affecting SQL Server
  - type: windows_event
    channel_path: System
    source: windows.events
    service: sccm-sql-server
    tags:
      - source:windows-system
      - role:sccm-sql-server
    log_processing_rules:
      - type: include_at_match
        name: critical_system_events
        pattern: '"EventID":"(7000|7001|7031|7034|7036|6008)"'

  # Application Event Log - SQL service failures and auth errors only
  - type: windows_event
    channel_path: Application
    source: windows.events
    service: sccm-sql-server
    tags:
      - source:sqlserver-application
      - role:sccm-sql-server
    log_processing_rules:
      - type: include_at_match
        name: sql_service_failures
        pattern: '"EventID":"(17061|17062|18456|18452)"'

  # Security Event Log - Authentication failures affecting database access
  - type: windows_event
    channel_path: Security
    source: windows.events
    service: sccm-sql-server
    tags:
      - source:windows-security
      - role:sccm-sql-server
    log_processing_rules:
      - type: include_at_match
        name: auth_failures
        pattern: '"EventID":"(4625|4771|4776)"'
