# Windows Service Check Configuration for SCCM SQL Server
# Monitors critical SQL Server and infrastructure services
# Updated with proper service grouping and tagging per Datadog best practices

init_config:

instances:
  # Core SQL Server Services
  - services:
      - MSSQLSERVER
      - SQLSERVERAGENT
    tags:
      - role:sccm-sql-server
      - service_group:sql-server-core
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # SQL Server Support Services
  - services:
      - SQLBrowser
      - SQLWriter
      - MSDTC
    tags:
      - role:sccm-sql-server
      - service_group:sql-server-support
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # Windows Infrastructure Services
  - services:
      - Winmgmt
      - WinRM
    tags:
      - role:sccm-sql-server
      - service_group:windows-infrastructure
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # SQL Server Named Instances (if applicable)
  - services:
      - name: MSSQL\$.*
        startup_type: automatic
    tags:
      - role:sccm-sql-server
      - service_group:sql-server-named-instances
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true

  # SQL Server Always On Services (if applicable)
  - services:
      - MSSQLSERVER_HADR
      - SQLSERVERAGENT_HADR
    tags:
      - role:sccm-sql-server
      - service_group:sql-server-alwayson
      - environment:production
    windows_service_startup_type_tag: true
    collect_display_name_as_tag: true
    disable_legacy_service_tag: true