<?xml version="1.0" encoding="UTF-8"?>
<datadog-widgets>
  <description>SCCM IIS Performance Widget Configurations for Management Points and Distribution Points</description>
  
  <!-- IIS Current Connections Widget -->
  <widget id="iis-connections-widget" type="query_value">
    <title>IIS Current Connections (Management Points)</title>
    <query>avg:iis.current_connections{role:sccm-management-point}</query>
    <thresholds>
      <critical operator=">" value="2000" color="red"/>
      <warning operator=">" value="1000" color="yellow"/>
      <ok operator="<=" value="1000" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>connections</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Requests per Second Widget -->
  <widget id="iis-requests-widget" type="query_value">
    <title>IIS Requests per Second</title>
    <query>avg:iis.requests_per_sec{role:sccm-management-point OR role:sccm-distribution-point}</query>
    <thresholds>
      <critical operator=">" value="200" color="red"/>
      <warning operator=">" value="100" color="yellow"/>
      <ok operator="<=" value="100" color="green"/>
    </thresholds>
    <precision>1</precision>
    <unit>req/sec</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Request Queue Length Widget -->
  <widget id="iis-queue-widget" type="query_value">
    <title>IIS Request Queue Length</title>
    <query>avg:iis.request_queue_length{role:sccm-management-point OR role:sccm-distribution-point}</query>
    <thresholds>
      <critical operator=">" value="25" color="red"/>
      <warning operator=">" value="10" color="yellow"/>
      <ok operator="<=" value="10" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>requests</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Response Time Widget -->
  <widget id="iis-response-time-widget" type="query_value">
    <title>IIS Average Response Time</title>
    <query>avg:iis.avg_response_time{role:sccm-management-point OR role:sccm-distribution-point}</query>
    <thresholds>
      <critical operator=">" value="5000" color="red"/>
      <warning operator=">" value="2000" color="yellow"/>
      <ok operator="<=" value="2000" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>ms</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Requests Timeline Widget -->
  <widget id="iis-requests-timeline-widget" type="timeseries">
    <title>IIS Requests per Second by Server Role</title>
    <queries>
      <query metric="avg:iis.requests_per_sec{role:sccm-management-point} by {host}" 
             display="line" palette="cool" label="Management Point"/>
      <query metric="avg:iis.requests_per_sec{role:sccm-distribution-point} by {host}" 
             display="line" palette="warm" label="Distribution Point"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <markers>
      <marker value="100" type="warning" style="dashed"/>
      <marker value="200" type="error" style="dashed"/>
    </markers>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- IIS Connections Timeline Widget -->
  <widget id="iis-connections-timeline-widget" type="timeseries">
    <title>IIS Current Connections Over Time</title>
    <queries>
      <query metric="avg:iis.current_connections{role:sccm-management-point} by {host}" 
             display="line" palette="cool" label="Management Point"/>
      <query metric="avg:iis.current_connections{role:sccm-distribution-point} by {host}" 
             display="line" palette="warm" label="Distribution Point"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <markers>
      <marker value="1000" type="warning" style="dashed"/>
      <marker value="2000" type="error" style="dashed"/>
    </markers>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- IIS Response Time Timeline Widget -->
  <widget id="iis-response-timeline-widget" type="timeseries">
    <title>IIS Average Response Time</title>
    <queries>
      <query metric="avg:iis.avg_response_time{role:sccm-management-point} by {host}" 
             display="line" palette="cool" label="Management Point"/>
      <query metric="avg:iis.avg_response_time{role:sccm-distribution-point} by {host}" 
             display="line" palette="warm" label="Distribution Point"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <markers>
      <marker value="2000" type="warning" style="dashed"/>
      <marker value="5000" type="error" style="dashed"/>
    </markers>
    <unit>ms</unit>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- IIS Queue Length Timeline Widget -->
  <widget id="iis-queue-timeline-widget" type="timeseries">
    <title>IIS Request Queue Length Over Time</title>
    <queries>
      <query metric="avg:iis.request_queue_length{role:sccm-management-point} by {host}" 
             display="bars" palette="cool" label="Management Point"/>
      <query metric="avg:iis.request_queue_length{role:sccm-distribution-point} by {host}" 
             display="bars" palette="warm" label="Distribution Point"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <markers>
      <marker value="10" type="warning" style="dashed"/>
      <marker value="25" type="error" style="dashed"/>
    </markers>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- IIS Error Rate Widget -->
  <widget id="iis-error-rate-widget" type="query_value">
    <title>IIS Error Rate</title>
    <query>avg:iis.errors_per_sec{role:sccm-management-point OR role:sccm-distribution-point}</query>
    <thresholds>
      <critical operator=">" value="10" color="red"/>
      <warning operator=">" value="5" color="yellow"/>
      <ok operator="<=" value="5" color="green"/>
    </thresholds>
    <precision>2</precision>
    <unit>errors/sec</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Bytes Sent Widget -->
  <widget id="iis-bytes-sent-widget" type="query_value">
    <title>IIS Bytes Sent per Second</title>
    <query>avg:iis.bytes_sent_per_sec{role:sccm-distribution-point}</query>
    <precision>0</precision>
    <unit>bytes/sec</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Bytes Received Widget -->
  <widget id="iis-bytes-received-widget" type="query_value">
    <title>IIS Bytes Received per Second</title>
    <query>avg:iis.bytes_received_per_sec{role:sccm-management-point}</query>
    <precision>0</precision>
    <unit>bytes/sec</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- IIS Throughput Timeline Widget -->
  <widget id="iis-throughput-timeline-widget" type="timeseries">
    <title>IIS Data Throughput</title>
    <queries>
      <query metric="avg:iis.bytes_sent_per_sec{role:sccm-distribution-point} by {host}" 
             display="area" palette="warm" label="Bytes Sent (DP)"/>
      <query metric="avg:iis.bytes_received_per_sec{role:sccm-management-point} by {host}" 
             display="area" palette="cool" label="Bytes Received (MP)"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <unit>bytes/sec</unit>
    <size>
      <width>12</width>
      <height>3</height>
    </size>
  </widget>
  
</datadog-widgets>