<?xml version="1.0" encoding="UTF-8"?>
<datadog-widgets>
  <description>SCCM SQL Server Monitoring Widget Configurations</description>
  
  <!-- Buffer Cache Hit Ratio Widget -->
  <widget id="buffer-cache-widget" type="query_value">
    <title>SQL Server Buffer Cache Hit Ratio</title>
    <query>avg:sqlserver.buffer.cache_hit_ratio{role:sccm-sql-server}</query>
    <thresholds>
      <critical operator="<" value="85" color="red"/>
      <warning operator="<" value="90" color="yellow"/>
      <ok operator=">=" value="90" color="green"/>
    </thresholds>
    <precision>2</precision>
    <unit>%</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- Page Life Expectancy Widget -->
  <widget id="page-life-widget" type="query_value">
    <title>SQL Server Page Life Expectancy</title>
    <query>avg:sqlserver.buffer.page_life_expectancy{role:sccm-sql-server}</query>
    <thresholds>
      <critical operator="<" value="180" color="red"/>
      <warning operator="<" value="300" color="yellow"/>
      <ok operator=">=" value="300" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>seconds</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- Blocked Processes Widget -->
  <widget id="blocked-processes-widget" type="query_value">
    <title>SQL Server Blocked Processes</title>
    <query>avg:sqlserver.stats.processes_blocked{role:sccm-sql-server}</query>
    <thresholds>
      <critical operator=">" value="10" color="red"/>
      <warning operator=">" value="5" color="yellow"/>
      <ok operator="<=" value="5" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>processes</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- User Connections Widget -->
  <widget id="user-connections-widget" type="query_value">
    <title>SQL Server User Connections</title>
    <query>avg:sqlserver.stats.connections{role:sccm-sql-server}</query>
    <precision>0</precision>
    <unit>connections</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- Buffer Cache Timeline Widget -->
  <widget id="buffer-cache-timeline-widget" type="timeseries">
    <title>SQL Server Buffer Cache Hit Ratio Over Time</title>
    <queries>
      <query metric="avg:sqlserver.buffer.cache_hit_ratio{role:sccm-sql-server} by {host}" 
             display="line" palette="dog_classic" label="Buffer Cache Hit Ratio"/>
    </queries>
    <yaxis>
      <min>80</min>
      <max>100</max>
    </yaxis>
    <markers>
      <marker value="90" type="warning" style="dashed"/>
      <marker value="85" type="error" style="dashed"/>
    </markers>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- SQL Memory Timeline Widget -->
  <widget id="sql-memory-timeline-widget" type="timeseries">
    <title>SQL Server Memory Usage</title>
    <queries>
      <query metric="avg:sqlserver.memory.total_server_memory{role:sccm-sql-server} by {host}" 
             display="line" palette="cool" label="Total Server Memory"/>
      <query metric="avg:sqlserver.memory.target_server_memory{role:sccm-sql-server} by {host}" 
             display="line" palette="warm" label="Target Server Memory" style="dashed"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <unit>KB</unit>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- SCCM Client Count Widget -->
  <widget id="sccm-client-count-widget" type="query_value">
    <title>Total SCCM Clients</title>
    <query>max:sccm.client_count{*}</query>
    <precision>0</precision>
    <unit>clients</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- SCCM Database Size Widget -->
  <widget id="sccm-database-size-widget" type="query_value">
    <title>SCCM Database Size</title>
    <query>avg:sccm.database_size.used_space_bytes{database_name:sccm}</query>
    <precision>2</precision>
    <unit>GB</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- Critical Components Widget -->
  <widget id="critical-components-widget" type="query_value">
    <title>Critical SCCM Components</title>
    <query>sum:sccm.site_status.critical_components{*}</query>
    <thresholds>
      <critical operator=">" value="0" color="red"/>
      <ok operator="<=" value="0" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>components</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- Warning Components Widget -->
  <widget id="warning-components-widget" type="query_value">
    <title>Warning SCCM Components</title>
    <query>sum:sccm.site_status.warning_components{*}</query>
    <thresholds>
      <critical operator=">" value="5" color="red"/>
      <warning operator=">" value="0" color="yellow"/>
      <ok operator="<=" value="0" color="green"/>
    </thresholds>
    <precision>0</precision>
    <unit>components</unit>
    <size>
      <width>3</width>
      <height>2</height>
    </size>
  </widget>
  
  <!-- Blocked Processes Timeline Widget -->
  <widget id="blocked-processes-timeline-widget" type="timeseries">
    <title>SQL Server Blocked Processes Over Time</title>
    <queries>
      <query metric="avg:sqlserver.stats.processes_blocked{role:sccm-sql-server} by {host}" 
             display="bars" palette="warm" label="Blocked Processes"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <markers>
      <marker value="5" type="warning" style="dashed"/>
      <marker value="10" type="error" style="dashed"/>
    </markers>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
  <!-- User Connections Timeline Widget -->
  <widget id="user-connections-timeline-widget" type="timeseries">
    <title>SQL Server User Connections Over Time</title>
    <queries>
      <query metric="avg:sqlserver.stats.connections{role:sccm-sql-server} by {host}" 
             display="line" palette="purple" label="User Connections"/>
    </queries>
    <yaxis>
      <min>0</min>
    </yaxis>
    <size>
      <width>6</width>
      <height>3</height>
    </size>
  </widget>
  
</datadog-widgets>